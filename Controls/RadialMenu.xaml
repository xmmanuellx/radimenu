<UserControl x:Class="RadiMenu.Controls.RadialMenu"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Width="500" Height="500">
    <!-- Increased size slightly to accommodate larger hit area if needed, keeping visual size same via Elements -->
    
    <Grid x:Name="RootGrid" RenderTransformOrigin="0.5,0.5" Background="Transparent"
          MouseMove="RootGrid_MouseMove"
          MouseDown="RootGrid_MouseDown"
          MouseUp="RootGrid_MouseUp"
          MouseLeave="RootGrid_MouseLeave">
        <Grid.RenderTransform>
            <ScaleTransform x:Name="MenuScale" ScaleX="1" ScaleY="1"/>
        </Grid.RenderTransform>
        
        <!-- Shadow -->
        <Ellipse Width="270" Height="270"
                 HorizontalAlignment="Center" VerticalAlignment="Center">
            <Ellipse.Effect>
                <DropShadowEffect BlurRadius="30" ShadowDepth="0" Color="Black" Opacity="0.8"/>
            </Ellipse.Effect>
            <Ellipse.Fill>
                <SolidColorBrush Color="Transparent"/>
            </Ellipse.Fill>
        </Ellipse>
        
        <!-- Main BLACK background ring -->
        <Ellipse x:Name="MainRing"
                 Width="260" Height="260"
                 Fill="#FF0A0A0A"
                 HorizontalAlignment="Center" VerticalAlignment="Center"
                 IsHitTestVisible="False"/>
                 
        <Canvas Width="500" Height="500" HorizontalAlignment="Center" VerticalAlignment="Center" IsHitTestVisible="False">
             <Path x:Name="SectorHighlight"
                   Fill="#33FFFFFF" 
                   Canvas.Left="250" Canvas.Top="250">
                <Path.RenderTransform>
                    <RotateTransform x:Name="SectorRotation" Angle="0"/>
                </Path.RenderTransform>
            </Path>
        </Canvas>
        
        <!-- Items container (includes submenu arcs behind icons) -->
        <Canvas x:Name="ItemsCanvas" 
                Width="500" Height="500"
                HorizontalAlignment="Center" VerticalAlignment="Center"
                IsHitTestVisible="False"/>

        <!-- Selection Arc Container (AFTER ItemsCanvas so it's on top) -->
        <Canvas Width="500" Height="500" HorizontalAlignment="Center" VerticalAlignment="Center" IsHitTestVisible="False">
            <Path x:Name="SelectionIndicator"
                  StrokeThickness="4"
                  StrokeStartLineCap="Round"
                  StrokeEndLineCap="Round"
                  Canvas.Left="250" Canvas.Top="250">
                <Path.Stroke>
                    <SolidColorBrush Color="#FF0078D4"/>
                </Path.Stroke>
                <Path.RenderTransform>
                    <RotateTransform x:Name="SelectionRotation" Angle="0"/>
                </Path.RenderTransform>
            </Path>
        </Canvas>
        
        <!-- Center circle -->
        <Ellipse x:Name="CenterCircle"
                 Width="90" Height="90"
                 HorizontalAlignment="Center"
                 VerticalAlignment="Center"
                 Cursor="Hand"
                 MouseEnter="CenterCircle_MouseEnter"
                 MouseLeave="CenterCircle_MouseLeave"
                 MouseDown="CenterCircle_MouseDown">
            <Ellipse.Fill>
                <SolidColorBrush Color="#FF151515"/>
            </Ellipse.Fill>
        </Ellipse>
        
        <!-- Selection label -->
        <TextBlock x:Name="SelectionLabel"
                   Text=""
                   FontSize="13"
                   FontWeight="Normal"
                   Foreground="#CCCCCC"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   IsHitTestVisible="False"/>

        <!-- CUSTOM CONFIRMATION DIALOG OVERLAY -->
        <Grid x:Name="ConfirmationOverlay" 
              Visibility="Collapsed" 
              HorizontalAlignment="Stretch" 
              VerticalAlignment="Stretch"
              Background="Transparent">
            <!-- Dialog Box -->
            <Border Width="300" Height="150" 
                    Background="#1E1E1E" 
                    BorderBrush="#3C3C3C" 
                    BorderThickness="1" 
                    CornerRadius="8"
                    HorizontalAlignment="Center" 
                    VerticalAlignment="Center">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="20" ShadowDepth="5" Opacity="0.5"/>
                </Border.Effect>
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Title -->
                    <TextBlock x:Name="DialogTitle" 
                               Text="Confirmar" 
                               Foreground="White" 
                               FontWeight="Bold" 
                               FontSize="16"
                               HorizontalAlignment="Left"/>
                    
                    <!-- Message -->
                    <TextBlock x:Name="DialogMessage" 
                               Text="¿Está seguro?" 
                               Foreground="#DDDDDD" 
                               FontSize="14" 
                               TextWrapping="Wrap"
                               HorizontalAlignment="Left"
                               VerticalAlignment="Center"
                               Grid.Row="1"
                               Margin="0,10"/>
                    
                    <!-- Buttons -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Grid.Row="2" Margin="0,5,0,0">
                        <Button x:Name="BtnCancel" 
                                Content="Cancelar" 
                                Width="80" Height="30"
                                Margin="0,0,10,0"
                                Background="Transparent"
                                Foreground="#AAAAAA"
                                BorderThickness="0"
                                Click="BtnCancel_Click"/>
                                
                        <Button x:Name="BtnConfirm" 
                                Content="Confirmar" 
                                Width="80" Height="30" 
                                Background="#0078D4"
                                Foreground="White"
                                BorderThickness="0"
                                Click="BtnConfirm_Click">
                            <Button.Resources>
                                <Style TargetType="Border">
                                    <Setter Property="CornerRadius" Value="4"/>
                                </Style>
                            </Button.Resources>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</UserControl>
